# Phase 3: 分割と戦略（収束フェーズ）

## 目的
P2.5の発散思考の結果を受け、具体的な実行計画に収束させる。
タスク分類・ Worker 割り当て・テスト戦略・リスク軽減策を決定する。

## 前提
- P2.5 の代替案分析と推奨アプローチが記録されていること（Slice モードの場合は P2.5S の結果）

## Slice モード判定

P2.5S（Vertical Slice Mode）から来た場合、以下を簡略化する:
- Step 1: Worker 数は原則1。並列化しない。
- Step 2: Test Phase = Slice（ビルド成功 + スモークのみ）。
- Step 3: リスクは P2.5S で既に1件記録済み。追加不要。
- Step 4: マイルストーン紐付けは通常通り実施。

簡略化した場合でも、MISSION_LOG.md への記録は必須。

---

## 手順

### Step 1: タスク分類
1. タスクを Tier 1/2/3 で分類
2. 並列化可能性を判断（最大3 Worker）
3. 各Workerの Focus Area / Forbidden Area を決定

### Step 2: テスト戦略の決定
0. **Test Phase の判定**（必須）:
   - タスクが新規機能の初回実装（インターフェース未確定）→ **Slice**
   - 既存機能の拡充・パラメータ調整（インターフェース確定済）→ **Stable**
   - リリース準備・回帰防止 → **Hardening**
   - Test Phase をチケットに明記する（`00_core.md` のテストフェーズ判定に準拠）
1. 各タスクに必要なテスト種別を決定（Test Phase に応じて必須/推奨を調整）:
   - **ユニットテスト**: ロジック単体の検証（EditMode / Jest 等）
   - **統合テスト**: 複数コンポーネント連携の検証（PlayMode / E2E 等）
   - **ビルド検証**: コンパイルエラーゼロの確認
2. 既存テストへの影響を確認（変更で壊れるテストはないか）
3. テスト不要なタスクには理由を明記

### Step 3: リスク軽減策の確定
1. P2.5 の Devil's Advocate で洗い出したリスクを具体的な軽減アクションに変換
2. 各リスクに対するフォールバックプランを決定

### Step 4: マイルストーンとの紐付け
1. 各タスクがどの短期/中期目標に属するかを明示
2. 目標に属さないタスクは「なぜ今やるのか」を説明する

4. MISSION_LOG.md を更新（Phase 3 完了を記録）

## 完了条件
- タスクが分類されている
- Worker 数と境界が決定されている
- **各タスクのテスト戦略が決定されている**
- **リスク軽減策が記録されている**
- **マイルストーンとの紐付けが明示されている**

## 次フェーズ
P4（チケット発行）

