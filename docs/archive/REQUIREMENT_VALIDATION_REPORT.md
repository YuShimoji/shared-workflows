# 要望妥当性検証レポート

**作成日**: 2026-01-05  
**検証者**: AI Assistant  
**対象**: shared-workflows 中央リポジトリ機能要件

---

## 要望サマリ

1. **進捗確認機能**: アイデアと実装度合いの対照表のようなわかりやすい進捗確認機能
2. **手動テストと自動テストの分離**: ユーザーが行う操作をステップバイステップでまとめる機能。確認コストも考慮
3. **視覚的な進捗表示**: コマンドラインでの記号を用いた装飾・メーターなど
4. **改善提案機能の明確化**: WorkerがShared Workflow側の改善提案はするが、各プロジェクトの機能改善提案をしない問題
5. **次のアクション選択肢の柔軟化**: 選択肢の数や推奨度のランク付け、現在積み上がっているタスクとの連携

---

## 現状調査結果

### 1. 進捗確認機能（アイデアと実装度合いの対照表）

**現状**:
- `docs/HANDOVER.md` に進捗が記録されている（タスクごとのDONE/IN_PROGRESS/OPEN）
- `docs/tasks/` にタスクチケットがある（Status: OPEN/IN_PROGRESS/DONE）
- `AI_CONTEXT.md` に進捗パーセンテージが記録されている
- **問題**: アイデア（バックログ/改善提案）と実装度合いを対照できる視覚的な表は存在しない

**妥当性**: ✅ **妥当** - 進捗の可視化はワークフロー改善に有効

### 2. 手動テストと自動テストの分離

**現状**:
- `docs/TEST_PROCEDURE.md` にテスト手順がある
- Workerのレポートにテスト結果が記録される（`## Verification` セクション）
- **問題**: 手動テストと自動テストの明確な分離はない。ユーザー向けのステップバイステップ手順はない

**妥当性**: ✅ **妥当** - ユーザーの確認コスト削減に有効

### 3. 視覚的な進捗表示

**現状**:
- `sw-doctor.js` にチェック結果の表示がある（✓/✗記号）
- **問題**: 進捗メーターやプログレスバーは存在しない。コマンドラインでの装飾的な表示は限定的

**妥当性**: ✅ **妥当** - モチベーション向上に有効

### 4. 改善提案機能の明確化

**現状**:
- `templates/ORCHESTRATOR_REPORT_TEMPLATE.md` に「改善提案（New Feature Proposal）」セクションがある
- WorkerがShared Workflow側の改善提案はする（例: `report-validator.js` の自動化）
- **問題**: 各プロジェクトの機能改善提案（例: NotebookLM/Gemini API実装）をしない

**妥当性**: ✅ **妥当** - プロジェクト側の改善提案も重要

### 5. 次のアクション選択肢の柔軟化

**現状**:
- `templates/ORCHESTRATOR_REPORT_TEMPLATE.md` に固定の3択がある
- `docs/windsurf_workflow/EVERY_SESSION.md` に終了時テンプレがある（選択肢1-3）
- **問題**: 選択肢の数や推奨度のランク付けはない。現在積み上がっているタスクとの連携はない

**妥当性**: ✅ **妥当** - より柔軟な意思決定支援に有効

---

## 改善提案

### 提案1: 進捗ダッシュボード機能

**目的**: アイデアと実装度合いを対照できる視覚的な表を提供

**実装方法**:
- `scripts/progress-dashboard.js` を新規作成
- `docs/tasks/` と `docs/HANDOVER.md` から進捗を集計
- バックログ（`AI_CONTEXT.md` の Backlog セクション）と実装済みタスクを対照
- Markdown形式のテーブルを生成（`docs/PROGRESS_DASHBOARD.md`）

**出力例**:
```markdown
| アイデア/機能 | 優先度 | 状態 | 進捗 | 担当 |
|------------|--------|------|------|------|
| Gemini API実装 | High | 設計済み | 30% | - |
| YouTube API連携 | Medium | 準備完了 | 50% | - |
| Git status代替手段 | Low | 実装済み | 100% | Worker |
```

### 提案2: テスト分離ドキュメント機能

**目的**: 手動テストと自動テストを分離し、ユーザー向けのステップバイステップ手順を提供

**実装方法**:
- `templates/TEST_MANUAL_TEMPLATE.md` を新規作成
- Workerレポートの `## Verification` セクションを解析し、手動テストと自動テストを分離
- `scripts/generate-test-steps.js` を新規作成（レポートから手動テスト手順を抽出）
- 確認コスト（所要時間）を各ステップに記載

**出力例**:
```markdown
## 手動テスト手順（ユーザー実行）

### ステップ1: 環境確認（所要時間: 2分）
1. `node .shared-workflows/scripts/sw-doctor.js --profile shared-orch-bootstrap` を実行
2. ERROR が無いことを確認

### ステップ2: 機能確認（所要時間: 5分）
1. [具体的な操作手順]
2. [期待される結果]

## 自動テスト結果（AI実行済み）
- `report-validator.js`: ✅ PASS
- `sw-doctor.js`: ✅ PASS
```

### 提案3: 視覚的進捗表示機能

**目的**: コマンドラインでの記号を用いた装飾・メーターを提供

**実装方法**:
- `scripts/progress-meter.js` を新規作成
- `docs/tasks/` から進捗を集計し、プログレスバーを生成
- Unicode記号を使用（例: `████████░░ 80%`）

**出力例**:
```bash
$ node scripts/progress-meter.js

📊 プロジェクト進捗
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
全体進捗: ████████████████░░░░ 80%
完了タスク: 8/10
進行中: 1
未着手: 1

🎯 優先度別進捗
High:   ████████████████████ 100% (2/2)
Medium: ████████████░░░░░░░░  60% (3/5)
Low:    ██████░░░░░░░░░░░░░░  30% (1/3)
```

### 提案4: 改善提案機能の明確化

**目的**: プロジェクト側とShared Workflow側の改善提案を分離

**実装方法**:
- `templates/ORCHESTRATOR_REPORT_TEMPLATE.md` の「改善提案」セクションを拡張
- プロジェクト側とShared Workflow側を明示的に分離
- Workerプロンプトに「プロジェクト側の改善提案も含める」指示を追加

**テンプレート変更**:
```markdown
## 改善提案（New Feature Proposal）

### プロジェクト側（<PROJECT_NAME>）
- 優先度: High/Medium/Low - <提案内容> - <状態>
- 優先度: High/Medium/Low - <提案内容> - <状態>

### Shared Workflow側（.shared-workflows submodule）
- 優先度: High/Medium/Low - <提案内容> - <状態>
```

### 提案5: 次のアクション選択肢の柔軟化

**目的**: 選択肢の数や推奨度のランク付け、現在積み上がっているタスクとの連携

**実装方法**:
- `scripts/generate-action-choices.js` を新規作成
- `docs/tasks/` からOPEN/IN_PROGRESSタスクを読み込み
- 優先度と依存関係を考慮して選択肢を生成
- 推奨度をランク付け（例: ⭐⭐⭐ 推奨 / ⭐⭐ 検討 / ⭐ 低優先度）

**テンプレート変更**:
```markdown
## 次のアクション

- <次に実施するアクション（担当/優先度）>

**ユーザー返信テンプレ（必須）**:
- 【確認】完了判定: 完了 / 未完了
- 【次に私（ユーザー）が返す内容】以下から1つ選んで返信します:

### 推奨アクション
1) ⭐⭐⭐ 「選択肢1を実行して」: <選択肢1> - <理由>
2) ⭐⭐ 「選択肢2を実行して」: <選択肢2> - <理由>

### その他の選択肢
3) ⭐ 「選択肢3を実行して」: <選択肢3> - <理由>
4) ⭐ 「選択肢4を実行して」: <選択肢4> - <理由>

### 現在積み上がっているタスクとの連携
- 選択肢1を実行すると、TASK_XXX（優先度: High）の前提条件が整います
- 選択肢2を実行すると、TASK_YYY（優先度: Medium）と並行して進められます
```

---

## 実装優先度

1. **高優先度**: 改善提案機能の明確化（提案4）
2. **高優先度**: 次のアクション選択肢の柔軟化（提案5）
3. **中優先度**: 進捗ダッシュボード機能（提案1）
4. **中優先度**: テスト分離ドキュメント機能（提案2）
5. **低優先度**: 視覚的進捗表示機能（提案3）

---

## 影響範囲

### 変更が必要なファイル

1. `templates/ORCHESTRATOR_REPORT_TEMPLATE.md` - 改善提案セクションの拡張、次のアクションセクションの拡張
2. `prompts/orchestrator/modules/P6_report.md` - レポート生成時の改善提案分離ロジック追加
3. `prompts/every_time/WORKER_COMPLETION_DRIVER.txt` - プロジェクト側改善提案の指示追加
4. `docs/windsurf_workflow/EVERY_SESSION.md` - 終了時テンプレの拡張

### 新規作成が必要なファイル

1. `scripts/progress-dashboard.js` - 進捗ダッシュボード生成スクリプト
2. `scripts/generate-test-steps.js` - テスト手順生成スクリプト
3. `scripts/progress-meter.js` - 視覚的進捗表示スクリプト
4. `scripts/generate-action-choices.js` - アクション選択肢生成スクリプト
5. `templates/TEST_MANUAL_TEMPLATE.md` - 手動テストテンプレート
6. `docs/PROGRESS_DASHBOARD.md` - 進捗ダッシュボード（自動生成）

---

## 検証方法

1. **進捗ダッシュボード**: `node scripts/progress-dashboard.js` を実行し、`docs/PROGRESS_DASHBOARD.md` が正しく生成されることを確認
2. **テスト分離**: Workerレポートから手動テスト手順が正しく抽出されることを確認
3. **視覚的進捗**: `node scripts/progress-meter.js` を実行し、プログレスバーが正しく表示されることを確認
4. **改善提案分離**: Orchestratorレポートにプロジェクト側とShared Workflow側の改善提案が分離されて記載されることを確認
5. **アクション選択肢**: 選択肢がタスクと連携し、推奨度がランク付けされていることを確認

---

## 次のステップ

1. 本レポートをレビューし、実装方針を決定
2. 優先度の高い機能（提案4、提案5）から実装開始
3. 実装後、動作確認とユーザーフィードバック収集
4. 必要に応じて改善を繰り返す
