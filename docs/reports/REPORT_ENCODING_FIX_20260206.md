# エンコーディング修復レポート

**Timestamp**: 2026-02-06T11:45:00+09:00
**Actor**: Cascade
**Type**: Bug Fix
**Commit**: cde5aa2

## 概要

プロジェクト全体で発生していたダブルエンコーディング（Shift_JIS/UTF-8混在）による文字化けを全件修復した。

## 問題の詳細

| 項目 | 内容 |
|------|------|
| 破損ファイル数 | 101個 |
| 影響範囲 | `docs/`, `templates/`, `prompts/orchestrator/`, `.github/`, ルートMD |
| 正常だったファイル | `prompts/every_time/`, `scripts/`, `data/` 等 |
| 原因コミット | `a2e1792` ("update: Sync shared workflows templates and prompts") |
| 最後の正常コミット | `0ba5eb1` ("Update shared workflows") |

### 破損パターン

- UTF-8のマルチバイトシーケンス中のバイトペアが `0x81 0x45` に置換されていた
- 例: `e6 83 85`（情）→ `e6 83 81 45`（惁E）
- Shift_JISリードバイト範囲（0x81-0x9F, 0xE0-0xEF）のバイトが影響を受けた
- ASCII文字も後続バイトとして巻き込まれるケースあり

## 修復手順

1. **破損ファイル特定**: UTF-8デコードテストで101ファイルを検出
2. **原因コミット特定**: `a2e1792` で破損導入、直前の `0ba5eb1` は正常
3. **全履歴スキャン**: 全コミットから各ファイルの正常UTF-8版を探索 → **101/101 全件発見**
4. **一括復元**: `0ba5eb1` から全101ファイルの正常バイナリを抽出・上書き
5. **検証**: 復元後に全ファイルのUTF-8デコードテスト → 破損ファイル 0件

## 修復結果

| 項目 | 結果 |
|------|------|
| 復元成功 | 101/101 |
| 復元失敗 | 0 |
| 復元後の破損ファイル | 0 |
| 正常UTF-8ファイル総数 | 175 |

## 再発防止の推奨事項

1. **`.gitattributes` でエンコーディング強制**: `*.md text eol=lf encoding=utf-8`
2. **同期スクリプトの見直し**: `a2e1792` のSync操作で使用されたツール/スクリプトにエンコーディング変換バグがないか確認
3. **CIでのエンコーディングチェック追加**: UTF-8バリデーションをpre-commitフックまたはCIパイプラインに組み込む
